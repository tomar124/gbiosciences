
{{ header }}
<style>
#data-table_filter {
  display:none; /*As per request only one search is required, currently labeled as "Search: Bio-Activity" so hide default one*/
}
 table#data-table td {
  font-size: .9em;
}
#data-table_wrapper input[type="search"] {
  padding: 0.4em;
}
.select2-container .select2-selection--single {
  height: 34px;
}
#bio-activity-search-wrapper {
  padding-right: 0px;
}
.dataTables_filter input { width: 260px }
</style>
<ul class="breadcrumb">
  {% for breadcrumb in breadcrumbs %}
    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
  {% endfor %}
</ul>
{% if j3.settings.get('pageTitlePosition') == 'top' %}
  <h1 class="title page-title"><span>{{ heading_title }}</span></h1>
{% endif %}
{{ j3.loadController('journal3/layout', 'top') }}
<div class="container">
  <div class="row">{{ column_left }}
    <div id="content">
      {% if j3.settings.get('pageTitlePosition') == 'default' %}
        <h1 class="title page-title">{{ heading_title }}</h1>
      {% endif %}
      {{ content_top }}
      {% if thumb or description %}
        <div class="">
          {% if thumb and j3.settings.get('categoryPageCategoryImageStatus') %}
          <img src="{{ thumb }}" {% if thumb2x %}srcset="{{ thumb }} 1x, {{ thumb2x }} 2x"{% endif %} alt="{{ heading_title }}" title="{{ heading_title }}" class="category-image"/>
          {% endif %}
          {% if description %}
            <div class="category-text">All orders will be reviewed for licensing and clearance before shipment {# description #}</div>
          {% endif %}</div>
      {% endif %}
      {% if j3.settings.get('subcategoriesStatus') %}
        {% if categories %}
          <div class="refine-categories refine-{{ j3.settings.get('subcategoriesDisplay') }}">
            {% if j3.settings.get('refineTitle') %}
              <h3 class="refine-title">{{ j3.settings.get('refineTitle') }}</h3>
            {% endif %}
            {% if j3.settings.get('subcategoriesDisplay') == 'carousel' %}
            <div class="swiper" data-items-per-row='{{ j3.settings.get('subcategoriesItemsPerRow')|json_encode(constant('JSON_FORCE_OBJECT')) }}' data-options='{"slidesPerColumn": 1}'>
              <div class="swiper-container" {% if j3.isRTL() %}dir="rtl"{% endif %}>
                <div class="swiper-wrapper">
                  {% else %}
                  <div class="refine-items">
                    {% endif %}
                    {% for category in categories %}
                      <div class="refine-item {% if j3.settings.get('subcategoriesDisplay') == 'carousel' %}swiper-slide{% endif %}">
                        <a href="{{ category.href }}">
                          {% if j3.settings.get('subcategoriesDisplay') != 'links' %}
                            <img src="{{ category.image }}" {% if category.image2x %}data-srcset="{{ category.image }} 1x, {{ category.image2x }} 2x"{% endif %} alt="{{ category.alt }}"/>
                          {% endif %}
                          <span class="refine-name">{{ category.name }}</span>
                        </a>
                      </div>
                    {% endfor %}
                    {% if j3.settings.get('subcategoriesDisplay') != 'carousel' %}
                  </div>
                  {% else %}
                </div>
              </div>
              <div class="swiper-buttons">
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
              </div>
              <div class="swiper-pagination"></div>
            </div>
            {% endif %}
          </div>
        {% endif %}
      {% endif %}
            
            <br>

            {% if special_product_filter_options %}
              <div class="row special-product-filters">
                {% for special_product_filter in special_product_filter_options  %}
                  
                     <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6">
                      <div class="form-group">

                        <label class="control-label">{{ special_product_filter.name }}</label>
                        <select class="form-control" id="option_{{ special_product_filter.special_product_filter_group_id }}">
                          <option value="">{{ '-- Any ---' }}</option>
                          {% for select_dropdown_filter_options_values in special_product_filter.options  %}
                            <option value="{{ select_dropdown_filter_options_values.special_product_filter_id }}">{{ select_dropdown_filter_options_values.name }}</option>
                          {% endfor %}
                        </select>

                      </div>
                    </div>
                {% endfor %}

                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6">
                <div class="form-group" id="bio-activity-search-wrapper">
                  <label class="control-label">Search</label>
                  <input class="form-control form-control-sm" id="bio-activity-search" type="text" placeholder="Search ..."/>
                </div>
              </div>
              </div>
            {% endif %}
            
      <div class="category-info-datatables">        
        <div class="table-responsive">
          <table class="cell-border hover order-column" id="data-table" data-page-length='10' cellspacing="0" width="100%"></table>
        </div>
      </div>
      {{ content_bottom }}</div>
    {{ column_right }}</div>
</div>
<script type="text/javascript">
    function addToQuote(product_id){
        var products = new Array();
        
        products.push({product_id : product_id, quantity: 1})
        
        $.ajax({
		url: 'index.php?route=account/wishlist/add',
		type: 'post',
		data: { products },
		dataType: 'json',
		beforeSend: function() {
			$('#addToQuote'+product_id).html('<span class="fa fa-spin"><i class="glyphicon glyphicon-repeat"></i></span>');
		},
		complete: function() {
			$('#addToQuote'+product_id).html('<i class="glyphicon glyphicon-list-alt"></i>');
		},
		success: function(json) {
			$('.success, .warning, .attention, .information').remove();

                        if (json['redirect']) {
                            location = json['redirect'];
                        }

                        if (json['success']) {
                            if (json['notification']) {
                                parent.show_notification(json['notification']);
                            } else {
                                parent.$('#content').parent().before('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
                            }

                            $('.success').fadeIn('slow');

                            try {
                                $('.wishlist-total .product-count').html(json['total'].match(/\(\d+\)/g)[0].replace('(', '').replace(')', ''));
                            } catch (e) { }

                            if (Journal.scrollToTop) {
                                $('html, body').animate({ scrollTop: 0 }, 'slow');
                            }
                        }
		},
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
	});
    }
    function addToCart(product_id){
        var products = new Array();
        
        products.push({product_id : product_id, quantity: 1})
        
        $.ajax({
		url: 'index.php?route=checkout/cart/add',
		type: 'post',
		data: { products },
		dataType: 'json',
		beforeSend: function() {
			$('#addToCart'+product_id).html('<span class="fa fa-spin"><i class="glyphicon glyphicon-repeat"></i></span>');
		},
		complete: function() {
			$('#addToCart'+product_id).html('<i class="glyphicon glyphicon-shopping-cart"></i>');
		},
		success: function(json) {
			$('.success, .warning, .attention, .information').remove();

                        if (json['redirect']) {
                            location = json['redirect'];
                        }

                        if (json['success']) {
                            if (json['notification']) {
                                parent.show_notification(json['notification']);
                            } else {
                                parent.$('#content').parent().before('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
                            }

                            $('.success').fadeIn('slow');
                            
                            parent.$('#cart-total').html(json['total']);
                            parent.$('#cart-items').html(json['items_count']);
                            
                            parent.$('.cart-content ul').load('index.php?route=common/cart/info ul li');
                            
                            try {
                                $('.wishlist-total .product-count').html(json['total'].match(/\(\d+\)/g)[0].replace('(', '').replace(')', ''));
                            } catch (e) { }

                            if (Journal.scrollToTop) {
                                $('html, body').animate({ scrollTop: 0 }, 'slow');
                            }
                            
                        }
		},
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
	});
    }
</script>
<script type="text/javascript">
    $(document).ready(function(){
console.log({{columns_data}});
            $('select[id^="option_"]').select2();
            $('select[id^="option_"]').on('change', function() {
                table.fnDraw();
            });
            
        
            var table = $('#data-table').dataTable({
            searching: true,
            bFilter: true,
            bProcessing: true,
            bServerSide: true,
            columns: {{ columns_data }},
            order: [[ 1, "asc" ]],
            columnDefs: [
                { width: "20%", "targets": 0 },
                { width: "25%", "targets": 1 },
                { width: "25%", "targets": 2 },
                { width: "20%", "targets": 3 },
                { width: "15%", "targets": 4 },
                /*                
                { width: "10%", "targets": 5 },
                { width: "10%", "targets": 6 },
                { width: "10%", "targets": 7 }
                */
            ],
            sAjaxSource: 'index.php?route=product/category/getGMCSpecialCategoryProducts',
            aaSorting: [[1, 'asc']],
            fnServerParams: function (aoData) {
                aoData.push( { "name": "category_id", "value": '{{ category_id }}' }, { "name": "path", "value": '{{ path }}' } );
            
                {% for special_product_filter in special_product_filter_options  %}
                        aoData.push( { "name": "special_product_filter_options[{{ special_product_filter.special_product_filter_group_id }}]", "value": $('#option_'+ {{ special_product_filter.special_product_filter_group_id }}).val() } );
                {% endfor %}
            
            },
            fnPreDrawCallback: function () {
                return true;
            },
            fnDrawCallback: function () {},
            "pagingType": "numbers"
        });

            $('#bio-activity-search').on('keyup', function() {
              table.api().columns([0,1]).search(this.value).draw();
            });
            
    });
</script>
{{ j3.loadController('journal3/seo/rich_snippets', breadcrumbs) }}
{{ footer }}